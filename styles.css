/* 浮动按钮样式 */
#outlook-to-notion-btn {
    position: fixed !important;
    top: 20px !important;
    right: 80px !important;
    width: 50px !important;
    height: 50px !important;
    background: linear-gradient(135deg, #4299e1, #3182ce) !important;
    color: white !important;
    border: none !important;
    border-radius: 50% !important;
    cursor: pointer !important;
    z-index: 10000 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 20px !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
    transition: all 0.3s ease !important;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
}

#outlook-to-notion-btn:hover {
    transform: scale(1.1) !important;
    box-shadow: 0 6px 20px rgba(0,0,0,0.25) !important;
    background: linear-gradient(135deg, #3182ce, #2c5aa0) !important;
}

#outlook-to-notion-btn:active {
    transform: scale(0.95) !important;
    transition: all 0.1s ease !important;
}

/* 邮件内容高亮样式 */
.outlook-to-notion-highlight {
    outline: 3px solid #4299e1 !important;
    border-radius: 4px !important;
    animation: pulse-highlight 2s ease-in-out !important;
}

@keyframes pulse-highlight {
    0% {
        outline-color: #4299e1;
        box-shadow: 0 0 0 0 rgba(66, 153, 225, 0.7);
    }
    50% {
        outline-color: #3182ce;
        box-shadow: 0 0 0 10px rgba(66, 153, 225, 0);
    }
    100% {
        outline-color: #4299e1;
        box-shadow: 0 0 0 0 rgba(66, 153, 225, 0);
    }
}

/* 确保按钮不会被其他元素遮挡 */
body {
    position: relative !important;
}

/* 为不同的Outlook版本提供适配 */
[data-testid="message-body"].outlook-to-notion-highlight,
.rps_1919.outlook-to-notion-highlight,
[class*="message-body"].outlook-to-notion-highlight {
    background-color: rgba(66, 153, 225, 0.05) !important;
}

/* 响应式设计 */
@media (max-width: 768px) {
    #outlook-to-notion-btn {
        right: 20px !important;
        top: 15px !important;
        width: 45px !important;
        height: 45px !important;
        font-size: 18px !important;
    }
}

/* 深色模式适配 */
@media (prefers-color-scheme: dark) {
    #outlook-to-notion-btn {
        background: linear-gradient(135deg, #2d3748, #1a202c) !important;
        border: 2px solid #4299e1 !important;
    }
    
    #outlook-to-notion-btn:hover {
        background: linear-gradient(135deg, #4299e1, #3182ce) !important;
        border-color: #63b3ed !important;
    }
}

/* 提示工具提示样式 */
#outlook-to-notion-btn::after {
    content: attr(title);
    position: absolute;
    bottom: -35px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 10001;
}

#outlook-to-notion-btn:hover::after {
    opacity: 1;
}

/* 加载状态样式 */
.outlook-to-notion-loading {
    animation: spin 1s linear infinite !important;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

/* 成功状态样式 */
.outlook-to-notion-success {
    background: linear-gradient(135deg, #48bb78, #38a169) !important;
    animation: success-pulse 1s ease-out !important;
}

@keyframes success-pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.7);
    }
    50% {
        transform: scale(1.1);
        box-shadow: 0 0 0 10px rgba(72, 187, 120, 0);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(72, 187, 120, 0);
    }
}

/* 错误状态样式 */
.outlook-to-notion-error {
    background: linear-gradient(135deg, #f56565, #e53e3e) !important;
    animation: error-shake 0.5s ease-in-out !important;
}

@keyframes error-shake {
    0%, 100% {
        transform: translateX(0);
    }
    25% {
        transform: translateX(-5px);
    }
    75% {
        transform: translateX(5px);
    }
}
